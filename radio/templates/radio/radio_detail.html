{% extends 'radio/base.html' %}

{% block content %}

<div id="RadioPlayer" class="radio" data-stream="{{ object.stream_url }}">
    <div class="radio__previev">
        {% if object.preview %}
        <img src="{% if object.preview %}{{ object.preview.url }}{% else %}/media/previews/default.png{% endif %}" width="175" height="175"/>
        {% endif %}
    </div>
    <div class="radio__meta">
        <h2>{{ object.name }}</h2>
        <ul class="radio-ganre-list">
            {% for ganre in object.ganre.all %}
            <li><a href="{{ ganre.get_absolute_url }}">{{ ganre.name }}</a></li>
            {% endfor %}
        </ul>
        <a href="#Feedbacks"><small>Отзывы: {{ object.feedbacks.count }}</small></a>
    </div>
    <div class="radio__controls">
        <button id="PlayControl" class="material-symbols-outlined">play_arrow</button>
        <button id="PauseControl" class="material-symbols-outlined">pause</button>
        <input type="range" id="VolumeControl" min="0" step="0.1" max="1">
    </div>
</div>

<div id="Feedbacks">
    <h3>Отзывы о "{{ object.name }}" <small>({{ object.feedbacks.all.count }})</small></h3>

    <button class="toggler" data-target="#NewFeedbackPopup" data-class-name="hidden">Оставить отзыв</button>

    <div id="NewFeedbackPopup" class="popup hidden">
        <div class="popup__content">
            <button class="toggler material-symbols-outlined" data-target="#NewFeedbackPopup" data-class-name="hidden">close</button>
            <form>
                {% csrf_token %}
                {{ form }}
                <input type="submit" value="Отправить">
            </form>
        </div>
    </div>

    <div class="feedback-list">
        {% for item in object.feedbacks.all %}
        <div class="feedback-list__item">
            <h4>{{ item.username }}</h4>
            <small>{{ item.rating }}</small>
            <div>{{ item.message }}</div>
        </div>
        {% endfor %}
    </div>
</div>

{% endblock %}

{% block extrascript %}
{% load static %}
<script src="{% static 'radio/js/player.js' %}"></script>
{% endblock %}
